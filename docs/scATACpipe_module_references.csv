Sub-workflow,Module,Software,Functionality,Docker image,References
PREPROCESS_DEFAULT,FASTQC,FastQC (v0.11.9) [1],Perform fastq sequence quality assessment with FastQC.,hukai916/fastqc_0.11.9:0.1,"[1] Andrews, S. (2010). FastQC:  A Quality Control Tool for High Throughput Sequence Data [Online]. Available online at: http://www.bioinformatics.babraham.ac.uk/projects/fastqc/"
,SPLIT_FASTQ,bash,"Split FASTQ files into smaller chunks for each sample so that more parallel jobs can be spawned, and therefore faster.",hukai916/sinto_xenial:0.2,
,MATCH_CHUNK,bash,Ensure sample chunks match with sample names for downstream steps.,hukai916/sinto_xenial:0.2,
,ADD_BARCODE_TO_READ_CHUNKS,sinto (v0.7.5) [2],Add barcode to the front of each name line in the FASTQ chunk file. ,hukai916/sinto_xenial:0.2,
,ADD_BARCODE_TO_READS,sinto (v0.7.5) [2],Add barcode to the front of each name line in the FASTQ file. ,hukai916/sinto_xenial:0.2,[2] https://timoast.github.io/sinto/
,CUTADAPT,cutadapt (v3.4) [5],Trim off adapter sequences with Cutadapt.,hukai916/cutadapt_xenial:0.1,"[5] Martin, M. (2011). Cutadapt removes adapter sequences from high-throughput sequencing reads. EMBnet.Journal, 17(1), 10. https://doi.org/10.14806/ej.17.1.200"
,DOWNLOAD_FROM_UCSC,"wget, custom Python script",Download genome fasta file from UCSC website.,hukai916/miniconda3_xenial:0.1,
,DOWNLOAD_FROM_ENSEMBL,"wget, custom Python script",Download genome fasta file from ENSEMBL website.,hukai916/miniconda3_xenial:0.1,
,PREP_GENOME,SAMtools (v1.11) [7] and bash,"Cleanup genome file by extracting the primary genome and prepending ""chr"" to each contig.",hukai916/bwa_xenial:0.1,"[7] Li, H., Handsaker, B., Wysoker, A., Fennell, T., Ruan, J., Homer, N., Marth, G., Abecasis, G., & Durbin, R. (2009). The Sequence Alignment/Map format and SAMtools. Bioinformatics, 25(16), 2078–2079. https://doi.org/10.1093/bioinformatics/btp352"
,BWA_INDEX,bwa (v0.7.17) [6],Index genome file with BWA.,hukai916/bwa_xenial:0.1,"[6] Li, H., & Durbin, R. (2009). Fast and accurate short read alignment with Burrows-Wheeler transform. Bioinformatics, 25(14), 1754–1760. https://doi.org/10.1093/bioinformatics/btp324"
,BWA_MAP,bwa (v0.7.17) [6],Map reads to genome with BWA.,hukai916/bwa_xenial:0.1,"[6] Li, H., & Durbin, R. (2009). Fast and accurate short read alignment with Burrows-Wheeler transform. Bioinformatics, 25(14), 1754–1760. https://doi.org/10.1093/bioinformatics/btp324"
,FILTER_BAM,SAMtools (v1.11) [7] and bash (awk),Filter out unqualified reads from BAM files.,hukai916/pysam_xenial:0.1,"[7] Li, H., Handsaker, B., Wysoker, A., Fennell, T., Ruan, J., Homer, N., Marth, G., Abecasis, G., & Durbin, R. (2009). The Sequence Alignment/Map format and SAMtools. Bioinformatics, 25(16), 2078–2079. https://doi.org/10.1093/bioinformatics/btp352"
,COMBINE_BAM,SAMtools (v1.11) [7],Combine BAMs for each sample.,hukai916/pysam_xenial:0.1,"[7] Li, H., Handsaker, B., Wysoker, A., Fennell, T., Ruan, J., Homer, N., Marth, G., Abecasis, G., & Durbin, R. (2009). The Sequence Alignment/Map format and SAMtools. Bioinformatics, 25(16), 2078–2079. https://doi.org/10.1093/bioinformatics/btp352"
,DEDUP_BAM,sinto (v0.7.5) [2] and custom Python script,"Deduplicate BAM files using barcode sequences added in the front of name line or using ""CB"" tag.",hukai916/sinto_kai:0.3,[2] https://timoast.github.io/sinto/
,GET_WHITELIST_BARCODE,seqkit [4] and custom Python script,Determine the correct whitelist barcode to use.,hukai916/seqkit_0.16.1:0.1,"[4] Shen, W., Le, S., Li, Y., & Hu, F. (2016). SeqKit: A Cross-Platform and Ultrafast Toolkit for FASTA/Q File Manipulation. PLOS ONE, 11(10), e0163962. https://doi.org/10.1371/journal.pone.0163962"
,GET_VALID_BARCODE,custom R script,"Determine valid barcodes using ""inflection point"" method.",hukai916/r_utils:0.1,
,CORRECT_BARCODE,custom R script,Naive method for barcode correction: correct barcodes that are with 1 mismatch.,hukai916/r_utils:0.1,
,CORRECT_BARCODE_PHENIQS,"Pheniqs (v2.1.0) [3], custom Python scripts",Correct barcodes with Pheniqs and add barcode to FASTQ.,hukai916/pheniqs_xenial:0.1,[3] https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-021-04267-5
,TAG_BAM,sinto (v0.7.5) [2],"Add ""CB"" tag to BAM file.",hukai916/sinto_xenial:0.2,[2] https://timoast.github.io/sinto/
,QUALIMAP,qualimap (v2.2.2) [8],Perform bam QC analysis,hukai916/qualimap_xenial:0.1,"[8] García-Alcalde, F., Okonechnikov, K., Carbonell, J., Cruz, L. M., Götz, S., Tarazona, S., Dopazo, J., Meyer, T. F., & Conesa, A. (2012). Qualimap: evaluating next-generation sequencing alignment data. Bioinformatics, 28(20), 2678–2679. https://doi.org/10.1093/bioinformatics/bts503"
,GET_FRAGMENTS,sinto (v0.7.5) [2],Get fragment file from BAM.,hukai916/sinto_xenial:0.2,[2] https://timoast.github.io/sinto/
PREPROCESS_10XGENOMICS,MATCH_SAMPLE_NAME,bash,Match and rename sample names to prevent unexpected inconsistency.,hukai916/miniconda3_xenial:0.1,
,DOWNLOAD_FROM_UCSC,"wget, custom Python script",Download genome fasta file from UCSC website.,hukai916/miniconda3_xenial:0.1,
,DOWNLOAD_FROM_ENSEMBL,"wget, custom Python script",Download genome fasta file from ENSEMBL website.,hukai916/miniconda3_xenial:0.1,
,DOWNLOAD_FROM_UCSC_GTF,"wget, custom Python script",Download GTF file from UCSC website,hukai916/miniconda3_xenial:0.1,
,DOWNLOAD_FROM_ENSEMBL_GTF,"wget, custom Python script",Download GTF file from ENSEMBL website,hukai916/miniconda3_xenial:0.1,
,PREP_GENOME,SAMtools (v1.11) [7] and bash,"Cleanup genome file by extracting the primary genome and prepending ""chr"" to each contig.",hukai916/bwa_xenial:0.1,"[7] Li, H., Handsaker, B., Wysoker, A., Fennell, T., Ruan, J., Homer, N., Marth, G., Abecasis, G., & Durbin, R. (2009). The Sequence Alignment/Map format and SAMtools. Bioinformatics, 25(16), 2078–2079. https://doi.org/10.1093/bioinformatics/btp352"
,PREP_GTF,"gffread (v0.12.1) [12], custom Python scripts","Cleanup GTF file by: prepending ""chr""; sort by gene_id; add ""gene"" column if not available; make sure GTF contigs is a subset of genome.",hukai916/miniconda3_bio:0.1,"[12] Pertea, G., & Pertea, M. (2020). GFF Utilities: GffRead and GffCompare. F1000Research, 9, ISCB Comm J-304. https://doi.org/10.12688/f1000research.23297.2"
,CELLRANGER_INDEX,cellranger-atac [9],Create cellranger_atac genome index file.,hukai916/cellranger_atat_2.0.0:0.1,[9] https://support.10xgenomics.com/single-cell-atac/software/pipelines/latest/using/count
,CELLRANGER_ATAC_COUNT,cellranger-atac [9],Execute cellranger_atac count command.,hukai916/cellranger_atat_2.0.0:0.1,[9] https://support.10xgenomics.com/single-cell-atac/software/pipelines/latest/using/count
,FILTER_CELL,"SAMtools (v1.11) [7], custom Python scripts",Filter fragment and BAM file according to valid cells from filtered_peak_bc_matrix/barcodes.tsv (cellranger_atac_count output).,hukai916/sinto_xenial:0.2,"[7] Li, H., Handsaker, B., Wysoker, A., Fennell, T., Ruan, J., Homer, N., Marth, G., Abecasis, G., & Durbin, R. (2009). The Sequence Alignment/Map format and SAMtools. Bioinformatics, 25(16), 2078–2079. https://doi.org/10.1093/bioinformatics/btp352"
PREPROCESS_CHROMAP,MATCH_SAMPLE_NAME,bash,Match and rename sample names to prevent unexpected inconsistency.,hukai916/miniconda3_xenial:0.1,
,MERGE_SAMPLE,bash,Merge samples from different lanes.,hukai916/miniconda3_xenial:0.1,
,GET_WHITELIST_CHROMAP,seqkit [4] and custom Python script,Determine the correct whitelist barcode to use.,hukai916/seqkit_0.16.1:0.1,"[4] Shen, W., Le, S., Li, Y., & Hu, F. (2016). SeqKit: A Cross-Platform and Ultrafast Toolkit for FASTA/Q File Manipulation. PLOS ONE, 11(10), e0163962. https://doi.org/10.1371/journal.pone.0163962"
,DOWNLOAD_FROM_UCSC,"wget, custom Python script",Download genome fasta file from UCSC website.,hukai916/miniconda3_xenial:0.1,
,DOWNLOAD_FROM_ENSEMBL,"wget, custom Python script",Download genome fasta file from ENSEMBL website.,hukai916/miniconda3_xenial:0.1,
,DOWNLOAD_FROM_UCSC_GTF,"wget, custom Python script",Download GTF file from UCSC website,hukai916/miniconda3_xenial:0.1,
,DOWNLOAD_FROM_ENSEMBL_GTF,"wget, custom Python script",Download GTF file from ENSEMBL website,hukai916/miniconda3_xenial:0.1,
,PREP_GENOME,SAMtools (v1.11) [7] and bash,"Cleanup genome file by extracting the primary genome and prepending ""chr"" to each contig.",hukai916/bwa_xenial:0.1,"[7] Li, H., Handsaker, B., Wysoker, A., Fennell, T., Ruan, J., Homer, N., Marth, G., Abecasis, G., & Durbin, R. (2009). The Sequence Alignment/Map format and SAMtools. Bioinformatics, 25(16), 2078–2079. https://doi.org/10.1093/bioinformatics/btp352"
,PREP_GTF,"gffread (v.0.12.1) [12], custom Python scripts","Cleanup GTF file by: prepending ""chr""; sort by gene_id; add ""gene"" column if not available; make sure GTF contigs is a subset of genome.",hukai916/miniconda3_bio:0.1,"[12] Pertea, G., & Pertea, M. (2020). GFF Utilities: GffRead and GffCompare. F1000Research, 9, ISCB Comm J-304. https://doi.org/10.12688/f1000research.23297.2"
,CHROMAP_INDEX,Chromap (v0.1.4) [13],Create Chromap genome index file.,hukai916/chromap_xenial:0.2,"[13] Zhang, H., Song, L., Wang, X. et al. Fast alignment and preprocessing of chromatin profiles with Chromap. Nat Commun 12, 6566 (2021). https://doi.org/10.1038/s41467-021-26865-w"
,CHROMAP_ATAC,Chromap (v0.1.4) [13],"Execute ""chromap --preset atac"" command.",hukai916/chromap_xenial:0.2,"[13] Zhang, H., Song, L., Wang, X. et al. Fast alignment and preprocessing of chromatin profiles with Chromap. Nat Commun 12, 6566 (2021). https://doi.org/10.1038/s41467-021-26865-w"
,FRAG_TO_FREQ,"bash, custom Python script",Calculate fragment frequencies.,hukai916/pysam_xenial:0.1,
,GET_VALID_BARCODE_CHROMAP,custom R script,"Determine valid barcodes using ""inflection point"" method.",hukai916/r_utils:0.1,
,FILTER_CELL_CHROMAP,custom Python script,Filter valid fragments according to valid barcodes.,hukai916/sinto_xenial:0.2,
,DOWNLOAD_FROM_UCSC,"wget, custom Python script",Download genome fasta file from UCSC website.,hukai916/miniconda3_xenial:0.1,
,DOWNLOAD_FROM_ENSEMBL,"wget, custom Python script",Download genome fasta file from ENSEMBL website.,hukai916/miniconda3_xenial:0.1,
,DOWNLOAD_FROM_UCSC_GTF,"wget, custom Python script",Download GTF file from UCSC website,hukai916/miniconda3_xenial:0.1,
,DOWNLOAD_FROM_ENSEMBL_GTF,"wget, custom Python script",Download GTF file from ENSEMBL website,hukai916/miniconda3_xenial:0.1,
,PREP_GENOME,SAMtools (v1.11) [7] and bash,"Cleanup genome file by extracting the primary genome and prepending ""chr"" to each contig.",hukai916/bwa_xenial:0.1,"[7] Li, H., Handsaker, B., Wysoker, A., Fennell, T., Ruan, J., Homer, N., Marth, G., Abecasis, G., & Durbin, R. (2009). The Sequence Alignment/Map format and SAMtools. Bioinformatics, 25(16), 2078–2079. https://doi.org/10.1093/bioinformatics/btp352"
,PREP_GTF,"gffread (v.0.12.1) [12], custom Python scripts","Cleanup GTF file by: prepending ""chr""; sort by gene_id; add ""gene"" column if not available; make sure GTF contigs is a subset of genome.",hukai916/miniconda3_bio:0.1,"[12] Pertea, G., & Pertea, M. (2020). GFF Utilities: GffRead and GffCompare. F1000Research, 9, ISCB Comm J-304. https://doi.org/10.12688/f1000research.23297.2"
,ARCHR_CREATE_ARROWFILES,wrapper around ArchR::createArrowFiles() [10],Create Arrowfiles with fragment files.,hukai916/scatacpipe_downstream:0.2 (constructed using a custom ArchR built based on v1.0.1: https://github.com/hukai916/ArchR-1),"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_ADD_DOUBLETSCORES,wrapper around ArchR::addDoubletScores() [10],Add doublet scores using ArchR built-in algorithm.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_ARCHRPROJECT,wrapper around ArchR::ArchRProject() [10],Create ArchRProject object.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_ARCHRPROJECT_QC,wrapper around ArchR::ArchRProject() [10],Perform QC on ArchRProject.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_GET_ANNOTATION_BIOC,wrapper around custom ArchR::createGenomeAnnotation()/createGeneAnnotation().,Create ArchR annotation files given Bioconductor objects.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_CREATE_ARROWFILES_ANNOTATION,wrapper around ArchR::createArrowFiles() [10],Create Arrowfiles with fragment files given custom annotation files.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_ARCHRPROJECT_ANNOTATION,wrapper around ArchR::ArchRProject() [10],Create ArchRProject object given custom annotation files..,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,BUILD_BSGENOME,custom R script,Build BSgenome given custom genome fasta.,hukai916/r_utils:0.1,
,BUILD_TXDB,custom R script,Build TxDB given BSgenome and GTF file.,hukai916/r_utils:0.1,
,BUILD_GENOME_ANNOTATION,wrapper around custom ArchR::create_ArchR_genomeannotation(),"Build ArchR genome annotation file given BSgenom, gene annotation, and blacklist bed.",hukai916/r_utils:0.1,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,BUILD_GENE_ANNOTATION,wrapper around custom ArchR::create_ArchR_geneannotation_WO_OrgDb(),"Build ArchR gene annotation file given TxDb, GTF, and specit latin name.",hukai916/r_utils:0.1,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,PREP_FRAGMENT,"bash, custom Python script","Prepend ""chr"" in front of fragment file to match PREP_GTF; ensure fragment file col1 is a subset of GTF col1.",hukai916/miniconda3_bio:0.1,
,AMULET_DETECT_DOUBLETS,AMULET (v1.1) [14],Detect doublets using AMULET.,hukai916/amulet_xenial:0.1,"[14] Thibodeau, A., Eroglu, A., McGinnis, C.S. et al. AMULET: a novel read count-based method for effective multiplet detection from single nucleus ATAC-seq data. Genome Biol 22, 252 (2021). https://doi.org/10.1186/s13059-021-02469-x"
,AMULET_MERGE_DOUBLETS,bash,Simpy concatenate AMULET  results.,hukai916/amulet_xenial:0.1,
,AMULET_FILTER_DOUBLETS,"ArchR [10], custom R script",Filter AMULET detected doublets.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_FILTER_CELLS,"ArchR [10], custom R script",Filter out low quality cells.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_FILTER_DOUBLETS,ArchR [10],Filter out doublets using ArchR built-in algorithm.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_DIMENSION_REDUCTION,wrapper around ArchR::addIterativeLSI(),Perform dimension reduction.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_BATCH_CORRECTION,wrapper around ArchR::addHarmony(),Correct batch effect with Harmony.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_CLUSTERING,wrapper around ArchR::addClusters(),Perform clustering analysis.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_EMBEDDING,wrapper around ArchR::addTSNE/addUMAP/plotEmbedding(),Perform single-cell embedding.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_PSEUDO_BULK_CLUSTERS,wrapper around ArchR::addGroupCoverages(),Add pseudo bulks using scATAC-seq clusterings (scATACseq data only).,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_PSEUDO_BULK_CLUSTERS2,wrapper around ArchR::addGroupCoverages(),Add pseudo bulks using integrated scRNA-seq clusterings2 (integrated with scRNAseq data),hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_SCRNASEQ_UNCONSTRAINED,wrapper around ArchR::addGeneIntegrationMatrix(),Perform unconstrained scRNAseq integration.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_SCRNASEQ_CONSTRAINED,wrapper around addGeneIntegrationMatrix,Perform constrained scRNAseq integration.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_MARKER_GENE_CLUSTERS,wrapper around ArchR::getMarkerFeatures(),Find marker genes for each scATAC-seq clusters.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_MARKER_GENE_CLUSTERS2,wrapper around ArchR::getMarkerFeatures(),Find marker genes for each integrated scRNA-seq clusters2.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_CALL_PEAKS_CLUSTERS,wrapper around ArchR::addReproduciblePeakSet(),Call peaks for each scATAC-seq clusters,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_CALL_PEAKS_CLUSTERS2,wrapper around addReproduciblePeakSet,Call peaks for each integrated scRNA-seq clusters2.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_GET_MARKER_PEAKS_CLUSTERS,wrapper around ArchR::getMarkerFeatures(),Find marker peaks for each scATAC-seq clusters.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_GET_MARKER_PEAKS_CLUSTERS2,wrapper around ArchR::getMarkerFeatures(),Find marker peaks for each integrated scRNA-seq clusters2.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_MARKER_PEAKS_IN_TRACKS_CLUSTERS,wrapper around ArchR::plotBrowserTrack(),Plot marker peaks for each scATAC-seq clusters.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_MARKER_PEAKS_IN_TRACKS_CLUSTERS2,wrapper around ArchR::plotBrowserTrack(),Plot marker peaks for each integrated scRNA-seq clusters2.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_PAIRWISE_TEST_CLUSTERS,wrapper around ArchR::getMarkerFeatures(),Perform pairwise testing for selected scATAC-seq clusters.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_PAIRWISE_TEST_CLUSTERS2,wrapper around ArchR::getMarkerFeatures(),Perform pairwise testing for selected integrated scRNA-seq clusters2.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_MOTIF_ENRICHMENT_CLUSTERS,wrapper around ArchR::addMotifAnnotations/peakAnnoEnrichment(),Perform motif enrichment analysis using scATAC-seq clusters.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_MOTIF_ENRICHMENT_CLUSTERS2,wrapper around ArchR::addMotifAnnotations()/peakAnnoEnrichment(),Perform motif enrichment analysis using integrated scRNA-seq clusters2.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_MOTIF_DEVIATIONS_CLUSTERS,wrapper around ArchR::addDeviationsMatrix()/getVarDeviations(),Perform motif deviation analysis using scATAC-seq clusters.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_MOTIF_DEVIATIONS_CLUSTERS2,wrapper around ArchR::addDeviationsMatrix()/getVarDeviations(),Perform motif deviation analysis using integrated scRNA-seq clusters2.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_FOOTPRINTING_CLUSTERS,wrapper around ArchR::getFootprints()/plotFootprints(),Plot footprints using scATAC-seq clusters.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_FOOTPRINTING_CLUSTERS2,wrapper around ArchR::getFootprints()/plotFootprints(),Plot footprints using integrated scRNA-seq clusters2.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_COACCESSIBILITY_CLUSTERS,wrapper around ArchR::addCoAccessibility()/ getCoAccessibility(),Perform peak coaccessibility analysis with scATAC-seq clusters.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_COACCESSIBILITY_CLUSTERS2,wrapper around ArchR::addCoAccessibility()/getCoAccessibility(),Perform peak coaccessibility analysis with integrated scRNA-seq clusters2.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_PEAK2GENELINKAGE_CLUSTERS2,wrapper around ArchR::addPeak2GeneLinks()/getPeak2GeneLinks(),Perform peak2genelinkage analysis with integrated scRNA-seq clusters.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_GET_POSITIVE_TF_REGULATOR_CLUSTERS,wrapper around ArchR::getGroupSE()/correlateMatrices(),Get positive TF regulators with scATAC-seq clusters.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_GET_POSITIVE_TF_REGULATOR_CLUSTERS2,wrapper around ArchR::getGroupSE()/correlateMatrices(),Get positive TF regulators with integrated scRNA-seq clusters2.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_TRAJECTORY_CLUSTERS2,wrapper around trajectory analysis related ArchR functions,Perform cell trajectory analysis with integrated scRNA-seq clusters2.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
,ARCHR_GET_CLUSTERING_TSV,custom R script,Output a tsv file containing the clustering results.,hukai916/scatacpipe_downstream:0.2,"[10] Granja, J. M., Corces, M. R., Pierce, S. E., Bagdatli, S. T., Choudhry, H., Chang, H. Y., & Greenleaf, W. J. (2021). ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis. Nature Genetics, 53(3), 403–411. https://doi.org/10.1038/s41588-021-00790-6"
Other modules,SPLIT_BED,custom Python script,Split bed files according to clusterings.,hukai916/fastqc_0.11.9:0.1,
,SPLIT_BAM,"SAMtools (v1.11) [7], sinto (v0.7.5) [2]",Split bam files according to clusterings.,hukai916/sinto_xenial:0.2,"[7] Li, H., Handsaker, B., Wysoker, A., Fennell, T., Ruan, J., Homer, N., Marth, G., Abecasis, G., & Durbin, R. (2009). The Sequence Alignment/Map format and SAMtools. Bioinformatics, 25(16), 2078–2079. https://doi.org/10.1093/bioinformatics/btp352
[2] https://timoast.github.io/sinto/"
,MULTIQC,"MultiQC (v1.11) [11], custom Multiqc plugins",generate MultiQC report,hukai916/multiqc:0.1,"[11] Ewels, P., Magnusson, M., Lundin, S., & Käller, M. (2016). MultiQC: summarize analysis results for multiple tools and samples in a single report. Bioinformatics, 32(19), 3047–3048. https://doi.org/10.1093/bioinformatics/btw354"